#!/usr/bin/env bash
# shellcheck disable=SC1091

# HAProxy finish script for s6-overlay
# Handle exit code 143 (SIGTERM) as success

set -euo pipefail

# The first argument will be the exit code of your service,
# or 256 if your service was killed by an uncaught signal.
# The second argument is only meaningful if your service was
# killed by an uncaught signal, and contains the number of said signal.
exit_code="${1:-0}"

# Exit code 143 (SIGTERM) is success
if [[ "${exit_code}" -eq 143 ]]; then
    exit 0
fi

# Pass through other exit codes
exit "${exit_code}"
